{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.1", "generated_at": "2024-07-18T08:57:14.622020Z", "invocation_id": "1de9772b-64af-4dc3-ba4b-a057c3e69a2d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T08:52:29.986175Z", "completed_at": "2024-07-18T08:52:29.995176Z"}, {"name": "execute", "started_at": "2024-07-18T08:52:29.996540Z", "completed_at": "2024-07-18T08:54:12.999494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 103.01541447639465, "adapter_response": {"_message": "SELECT 13056225", "code": "SELECT", "rows_affected": 13056225}, "message": "SELECT 13056225", "failures": null, "unique_id": "model.dbt_homepedia.stg_dvf", "compiled": true, "compiled_code": "WITH source_data AS (\n    select\n         id, \n        \"No disposition\" AS No_disposition,\n        \"Date mutation\" AS Date_mutation,\n        \"Nature mutation\" AS Nature_mutation,\n        \"Valeur fonciere\" AS Valeur_fonciere,\n        \"No voie\" AS No_voie,\n        \"B/T/Q\" AS B_T_Q,\n        \"Type de voie\" AS Type_de_voie,\n        \"Code voie\" AS Code_voie,\n        \"Voie\" AS Voie,\n        \"Code postal\" AS Code_postal,\n        CASE \n            WHEN \"Commune\" like '%MARSEILLE%' THEN 'MARSEILLE'\n            WHEN \"Commune\" like '%PARIS%' THEN 'PARIS'\n            WHEN \"Commune\" like '%LYON%' THEN 'LYON'\n            ELSE \"Commune\"       \n        END AS Commune,\n        \"Code departement\" AS Code_departement,\n        CASE \n            WHEN \"Commune\" like '%MARSEILLE%' THEN '055'\n            WHEN \"Commune\" like '%PARIS%' THEN '056'\n            WHEN \"Commune\" like '%LYON%' THEN '123'\n            ELSE \"Code commune\"\n        END AS Code_commune,\n        \"Prefixe de section\" AS Prefixe_de_section,\n        \"Section\" AS Section,\n        CAST(\"No plan\" AS INTEGER) AS No_plan,\n        \"No Volume\" AS No_Volume,\n        \"1er lot\" AS premier_lot,\n        cast( \n\t        case\n            when replace(\"Surface Carrez du 1er lot\",',','.') = '' then '0' \n            else replace(\"Surface Carrez du 1er lot\",',','.') \n        end as decimal) AS Surface_Carrez_du_1er_lot,\n        \"2eme lot\" AS deuxieme_lot,\n        cast( \n\t        case\n            when replace(\"Surface Carrez du 2eme lot\",',','.') = '' then '0' \n            else replace(\"Surface Carrez du 2eme lot\",',','.') \n        end as decimal) AS Surface_carrez_du_2eme_lot,\n        \"3eme lot\"  AS troiseme_lot,\n        cast( \n\t        case\n            when replace(\"Surface Carrez du 3eme lot\",',','.') = '' then '0' \n            else replace(\"Surface Carrez du 3eme lot\",',','.') \n        end as decimal) AS Surface_Carrez_du_3eme_lot,\n        \"4eme lot\" AS quatrieme_lot,\n        cast( \n\t        case\n            when replace(\"Surface Carrez du 4eme lot\",',','.') = '' then '0' \n            else replace(\"Surface Carrez du 4eme lot\",',','.') \n        end as decimal) AS Surface_Carrez_du_4eme_lot,\n        \"5eme lot\"  cinquieme_lot,\n        cast( \n\t        case\n            when replace(\"Surface Carrez du 5eme lot\",',','.') = '' then '0' \n            else replace(\"Surface Carrez du 5eme lot\",',','.') \n        end as decimal) AS Surface_Carrez_du_5eme_lot,\n        \"Nombre de lots\" AS Nombre_de_lots,\n        CAST(\"Code type local\" AS INTEGER) AS Code_type_local,\n        \"Type local\" AS Type_local,\n        CAST(\"Surface reelle bati\" AS INTEGER) AS Surface_reelle_bati,\n        CAST(\"Nombre pieces principales\" AS INTEGER) AS Nombre_pieces_principales,\n        \"Nature culture\" AS Nature_culture,\n        \"Nature culture speciale\" AS Nature_culture_speciale,\n        \"Surface terrain\" AS Surface_terrain\n\n    from \n        lake.dvf_data\n)\n\nSELECT * FROM source_data", "relation_name": "\"homepedia\".\"homepedia_staging\".\"stg_dvf\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-18T08:54:13.006608Z", "completed_at": "2024-07-18T08:54:13.010499Z"}, {"name": "execute", "started_at": "2024-07-18T08:54:13.010499Z", "completed_at": "2024-07-18T08:57:14.541402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 181.53788924217224, "adapter_response": {"_message": "SELECT 5653012", "code": "SELECT", "rows_affected": 5653012}, "message": "SELECT 5653012", "failures": null, "unique_id": "model.dbt_homepedia.dvf_treated", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT\n        date_mutation,\n        no_voie,\n        voie,\n        commune,\n        code_postal,\n        code_departement,\n        code_commune,\n            COUNT(DISTINCT type_local) AS count_type_local,\n    CASE\n        WHEN COUNT(DISTINCT type_local) > 1 THEN 'lot'\n        ELSE MAX(type_local)\n    END AS type_local_or_lot,\n    sum(Nombre_pieces_principales) as total_pi\u00e8ces,\n    sum(distinct valeur_fonciere) AS total_valeur_fonciere,\n    sum(distinct surface_terrain) AS max_surface_terrain,\n    sum(distinct surface_reelle_bati) AS max_surface_reelle_bati\n    FROM\n        \"homepedia\".\"homepedia_staging\".\"stg_dvf\"\n    WHERE Nature_mutation = 'Vente' and SUBSTRING(CAST(code_postal  AS VARCHAR), 1, 2) <> '97' and valeur_fonciere > 0\n    GROUP BY\n        date_mutation,\n        no_voie,\n        voie,\n        commune,\n        code_postal,\n        code_departement,\n        code_commune\norder by  date_mutation, code_postal, voie, no_voie\n)\n\nSELECT\n    row_number() OVER () AS id,\n    *\nFROM\n    source_data", "relation_name": "\"homepedia\".\"homepedia\".\"dvf_treated\""}], "elapsed_time": 285.3062353134155, "args": {"defer": false, "populate_cache": true, "enable_legacy_logger": false, "quiet": false, "select": [], "log_level_file": "debug", "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "which": "run", "use_colors": true, "project_dir": "C:\\Users\\User\\Documents\\Projet Epitech\\T-DAT-902\\Db\\dbt", "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": false, "partial_parse_file_diff": true, "use_colors_file": true, "macro_debugging": false, "indirect_selection": "eager", "exclude": [], "source_freshness_run_project_hooks": false, "favor_state": false, "introspect": true, "invocation_command": "dbt run", "vars": {}, "printer_width": 80, "strict_mode": false, "partial_parse": true, "show_resource_report": false, "cache_selected_only": false, "log_level": "info", "static_parser": true, "empty": false, "log_path": "C:\\Users\\User\\Documents\\Projet Epitech\\T-DAT-902\\Db\\dbt\\logs", "print": true, "send_anonymous_usage_stats": true, "profiles_dir": "C:\\Users\\User\\Documents\\Projet Epitech\\T-DAT-902\\Db\\dbt", "version_check": true, "write_json": true}}